window.repositoryObject = {"parameters_custom_fields":[],"object_id":"f447","name":"equip.before_equipment_update_check_install_date","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"Hasura","id":"d4"}},{"field":"Schema","value":"equip"},{"field":"Name","value":"before_equipment_update_check_install_date"},{"field":"Type","value":"Function"}],"script":"CREATE OR REPLACE FUNCTION equip.before_equipment_update_check_install_date()\r\n RETURNS trigger\r\n LANGUAGE plpgsql\r\nAS $function$\r\nbegin\r\n  /* якщо нова дата установки менша ніж стара то нічого не мяніємо  */\r\n  IF new.install_date < old.install_date\r\n    THEN \r\n      new.install_date = old.install_date;\r\n      IF to_jsonb(new) ? 'pos_id' THEN new.pos_id = old.pos_id;\r\n      END IF;\r\n      IF to_jsonb(new) ? 'wh_id' THEN new.wh_id = old.wh_id;\r\n      END IF;\r\n      IF to_jsonb(new) ? 'w_order_no' THEN new.w_order_no = old.w_order_no;\r\n      END IF;\r\n      IF to_jsonb(new) ? 'contract_info' THEN new.contract_info = old.contract_info;\r\n      END IF;\r\n  END IF;  \r\n\r\n  RETURN new;\r\nend\r\n$function$","parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"trigger","custom_fields":{}}],"dependencies":{"uses":[],"used_by":[]},"imported_at":"2024-02-15 12:25"};