window.repositoryObject = {"parameters_custom_fields":[],"object_id":"f240","name":"public.operator_status_upsert_trigger","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"Hasura","id":"d4"}},{"field":"Schema","value":"public"},{"field":"Name","value":"operator_status_upsert_trigger"},{"field":"Type","value":"Function"}],"script":"CREATE OR REPLACE FUNCTION public.operator_status_upsert_trigger()\r\n RETURNS trigger\r\n LANGUAGE plpgsql\r\nAS $function$  \r\nbegin  \r\n  /* старое назначение - ставим время завершения */\r\n  UPDATE operator_status_log SET date_to = now() WHERE operator = new.operator AND date_to IS NULL;\r\n  /* новое назначение - ставим время начала */\r\n  INSERT INTO operator_status_log(operator,status,created_by) VALUES(new.operator,new.status,new.updated_by);\r\n  return new;\r\nend  \r\n$function$","parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"trigger","custom_fields":{}}],"dependencies":{"uses":[],"used_by":[]},"imported_at":"2024-02-15 12:25"};